"use strict";(self.webpackChunk_finos_perspective_docs=self.webpackChunk_finos_perspective_docs||[]).push([[805],{3905:function(e,a,t){t.d(a,{Zo:function(){return u},kt:function(){return b}});var n=t(7294),l=t.n(n);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function p(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=l().createContext({}),d=function(e){var a=l().useContext(s),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},u=function(e){var a=d(e.components);return l().createElement(s.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return l().createElement(l().Fragment,{},a)}},c=l().forwardRef((function(e,a){var t=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),u=d(t),c=n,b=u["".concat(i,".").concat(c)]||u[c]||m[c]||r;return t?l().createElement(b,o(o({ref:a},s),{},{components:t})):l().createElement(b,o({ref:a},s))}));function b(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var r=t.length,i=new Array(r);i[0]=c;var o={};for(var p in a)hasOwnProperty.call(a,p)&&(o[p]=a[p]);o.originalType=e,o.mdxType="string"==typeof e?e:n,i[1]=o;for(var s=2;s<r;s++)i[s]=t[s];return l().createElement.apply(null,i)}return l().createElement.apply(null,t)}c.displayName="MDXCreateElement"},5162:function(e,a,t){t.d(a,{Z:function(){return o}});var n=t(7294),l=t.n(n),r=t(8944),i="tabItem_Ymn6";function o(e){var a=e.children,t=e.hidden,n=e.className;return l().createElement("div",{role:"tabpanel",className:(0,r.Z)(i,n),hidden:t},a)}},5488:function(e,a,t){t.d(a,{Z:function(){return b}});var n=t(5773),l=t(7294),r=t.n(l),i=t(8944),o=t(2389),p=t(7392),s=t(7094),d=t(2466),u="tabList__CuJ",m="tabItem_LNqP";function c(e){var a,t,o=e.lazy,c=e.block,b=e.defaultValue,h=e.values,k=e.groupId,v=e.className,y=r().Children.map(e.children,(function(e){if((0,l.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),f=null!=h?h:y.map((function(e){var a=e.props;return{value:a.value,label:a.label,attributes:a.attributes}})),N=(0,p.l)(f,(function(e,a){return e.value===a.value}));if(N.length>0)throw new Error('Docusaurus error: Duplicate values "'+N.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var T=null===b?b:null!=(a=null!=b?b:null==(t=y.find((function(e){return e.props.default})))?void 0:t.props.value)?a:y[0].props.value;if(null!==T&&!f.some((function(e){return e.value===T})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+T+'" but none of its children has the corresponding value. Available values are: '+f.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var g=(0,s.U)(),w=g.tabGroupChoices,x=g.setTabGroupChoices,C=(0,l.useState)(T),j=C[0],Z=C[1],P=[],I=(0,d.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var O=w[k];null!=O&&O!==j&&f.some((function(e){return e.value===O}))&&Z(O)}var _=function(e){var a=e.currentTarget,t=P.indexOf(a),n=f[t].value;n!==j&&(I(a),Z(n),null!=k&&x(k,String(n)))},E=function(e){var a,t=null;switch(e.key){case"ArrowRight":var n,l=P.indexOf(e.currentTarget)+1;t=null!=(n=P[l])?n:P[0];break;case"ArrowLeft":var r,i=P.indexOf(e.currentTarget)-1;t=null!=(r=P[i])?r:P[P.length-1]}null==(a=t)||a.focus()};return r().createElement("div",{className:(0,i.Z)("tabs-container",u)},r().createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":c},v)},f.map((function(e){var a=e.value,t=e.label,l=e.attributes;return r().createElement("li",(0,n.Z)({role:"tab",tabIndex:j===a?0:-1,"aria-selected":j===a,key:a,ref:function(e){return P.push(e)},onKeyDown:E,onFocus:_,onClick:_},l,{className:(0,i.Z)("tabs__item",m,null==l?void 0:l.className,{"tabs__item--active":j===a})}),null!=t?t:a)}))),o?(0,l.cloneElement)(y.filter((function(e){return e.props.value===j}))[0],{className:"margin-top--md"}):r().createElement("div",{className:"margin-top--md"},y.map((function(e,a){return(0,l.cloneElement)(e,{key:a,hidden:e.props.value!==j})}))))}function b(e){var a=(0,o.Z)();return r().createElement(c,(0,n.Z)({key:String(a)},e))}},9502:function(e,a,t){t.r(a),t.d(a,{assets:function(){return m},contentTitle:function(){return d},default:function(){return h},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return c}});var n=t(5773),l=t(808),r=(t(7294),t(3905)),i=t(5488),o=t(5162),p=["components"],s={id:"table",title:"Table"},d=void 0,u={unversionedId:"table",id:"table",title:"Table",description:"The Table is Perspective's columnar data frame, analogous to a Pandas",source:"@site/docs/table.md",sourceDirName:".",slug:"/table",permalink:"/docs/table",draft:!1,tags:[],version:"current",frontMatter:{id:"table",title:"Table"},sidebar:"tutorialSidebar",previous:{title:"Python User Guide",permalink:"/docs/python"},next:{title:"View",permalink:"/docs/view"}},m={},c=[{value:"Schema and Types",id:"schema-and-types",level:2},{value:"Index and Limit",id:"index-and-limit",level:2},{value:"Update and Remove",id:"update-and-remove",level:2}],b={toc:c};function h(e){var a=e.components,t=(0,l.Z)(e,p);return(0,r.kt)("wrapper",(0,n.Z)({},b,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," is Perspective's columnar data frame, analogous to a Pandas\n",(0,r.kt)("inlineCode",{parentName:"p"},"DataFrame")," or Apache Arrow. ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," supports appending data, in-place updates,\nremoval by index, and notifications on update."),(0,r.kt)("p",null,"A ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," contains columns, each of which have a unique name, are strongly and\nconsistently typed, and contains rows of data conforming to the column's type.\nEach column in a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," must have the same number of rows, though not every row\nmust contain data; null-values are used to indicate missing values in the\ndataset."),(0,r.kt)("p",null,"The columns of a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," are ",(0,r.kt)("em",{parentName:"p"},"immutable after creation"),", which means their names\nand data types cannot be changed after the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," has been created. Columns\ncannot be added or deleted after creation, but a ",(0,r.kt)("inlineCode",{parentName:"p"},"View")," can be used to select an\narbitrary set of columns from the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),"."),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'var data = [\n    {x: 1, y: "a", z: true},\n    {x: 2, y: "b", z: false},\n    {x: 3, y: "c", z: true},\n    {x: 4, y: "d", z: false},\n];\n\nconst table1 = await worker.table(data);\n'))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'data = [\n    {"x": 1, "y": "a", "z": True},\n    {"x": 2, "y": "b", "z": False},\n    {"x": 3, "y": "c", "z": True},\n    {"x": 4, "y": "d", "z": False}\n];\n\ntable1 = perspective.Table(data)\n')))),(0,r.kt)("h2",{id:"schema-and-types"},"Schema and Types"),(0,r.kt)("p",null,"The mapping of a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),"'s column names to data types is referred to as a\n",(0,r.kt)("inlineCode",{parentName:"p"},"schema"),". Each column has a unique name and a single data type, and data types\nare expressed with a common vocabulary of across all supported host languages.\nIn Python, you may alternatively use native types over their String\ncounterparts:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'var schema = {\n    x: "integer",\n    y: "string",\n    z: "boolean",\n};\n\nconst table2 = await worker.table(schema);\n'))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'from datetime import date, datetime\n\nschema = {\n    "a": int,\n    "b": float,\n    "c": date,\n    "d": datetime,\n    "e": bool,\n    "f": str\n}\n\ntable2 = perspective.Table(schema)\n')))),(0,r.kt)("p",null,"When passing data directly to the ",(0,r.kt)("inlineCode",{parentName:"p"},"table()")," constructor, the type of each column\nis inferred automatically. In some cases, the inference algorithm may not return\nexactly what you'd like. For example, a column may be interpreted as a\n",(0,r.kt)("inlineCode",{parentName:"p"},"datetime")," when you intended it to be a ",(0,r.kt)("inlineCode",{parentName:"p"},"string"),", or a column may have no values\nat all (yet), as it will be updated with values from a real-time data source\nlater on. In these cases, create a ",(0,r.kt)("inlineCode",{parentName:"p"},"table()")," with a ",(0,r.kt)("em",{parentName:"p"},"schema"),"."),(0,r.kt)("p",null,"Once the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," has been created with a schema, further ",(0,r.kt)("inlineCode",{parentName:"p"},"update()")," calls will\nconver data types to conform with the schema; a column that is typed as a\n",(0,r.kt)("inlineCode",{parentName:"p"},"datetime"),", for example, can be updated with ",(0,r.kt)("inlineCode",{parentName:"p"},"date")," objects, ",(0,r.kt)("inlineCode",{parentName:"p"},"datetime")," objects,\n",(0,r.kt)("inlineCode",{parentName:"p"},"pandas.Timestamp"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"numpy.datetime64"),", and even valid millisecond/seconds from\nepoch timestamps. Similarly, updating string columns with integer data will\ncause a cast to string, updating floats with ints will cast to float, and etc.\nType conversion can also leverage Python converters, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"__int__"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"__float__"),", etc."),(0,r.kt)("h2",{id:"index-and-limit"},"Index and Limit"),(0,r.kt)("p",null,"Initializing a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," with an ",(0,r.kt)("inlineCode",{parentName:"p"},"index")," tells Perspective to treat a column as\nthe primary key, allowing in-place updates of rows. Only a single column (of any\ntype) can be used as an ",(0,r.kt)("inlineCode",{parentName:"p"},"index"),". Indexed ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," instances allow:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"In-place ",(0,r.kt)("em",{parentName:"li"},"updates")," whenever a new row shares an ",(0,r.kt)("inlineCode",{parentName:"li"},"index")," values with an\nexisting row"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Partial updates")," when such a row leaves some column values ",(0,r.kt)("inlineCode",{parentName:"li"},"undefined")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Removes")," to delete a row by ",(0,r.kt)("inlineCode",{parentName:"li"},"index"),".")),(0,r.kt)("p",null,"To create an indexed ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),", provide the ",(0,r.kt)("inlineCode",{parentName:"p"},"index")," property with a string column\nname to be used as an index:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'const indexed_table = await perspective.table(data, {index: "a"});\n'))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'indexed_table = perspective.Table(data, index="a");\n')))),(0,r.kt)("p",null,"Initializing a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," with a ",(0,r.kt)("inlineCode",{parentName:"p"},"limit")," sets the total number of rows the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),"\nis allowed to have. When the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," is updated, and the resulting size of the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," would exceed its ",(0,r.kt)("inlineCode",{parentName:"p"},"limit"),", rows that exceed ",(0,r.kt)("inlineCode",{parentName:"p"},"limit")," overwrite the oldest\nrows in the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),". To create a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," with a ",(0,r.kt)("inlineCode",{parentName:"p"},"limit"),", provide the ",(0,r.kt)("inlineCode",{parentName:"p"},"limit"),"\nproperty with an integer indicating the maximum rows:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const limit_table = await perspective.table(data, {limit: 1000});\n"))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"limit_table = perspective.Table(data, limit=1000);\n")))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("inlineCode",{parentName:"p"},"limit")," cannot be used in conjunction with ",(0,r.kt)("inlineCode",{parentName:"p"},"index"),".")),(0,r.kt)("h2",{id:"update-and-remove"},"Update and Remove"),(0,r.kt)("p",null,"Once a ",(0,r.kt)("inlineCode",{parentName:"p"},"Table")," has been created, it can be updated with new data conforming to\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),"'s ",(0,r.kt)("inlineCode",{parentName:"p"},"schema"),". The dataset used for ",(0,r.kt)("inlineCode",{parentName:"p"},"update()")," must conform with the\nformats supported by Perspective."),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'const schema = {\n    a: "integer",\n    b: "float",\n};\n\nconst table = await perspective.table(schema);\ntable.update(new_data);\n'))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'schema = {"a": int, "b": float}\n\ntable = perspective.Table(schema)\ntable.update(new_data)\n')))),(0,r.kt)("p",null,"Without an ",(0,r.kt)("inlineCode",{parentName:"p"},"index")," set, calls to ",(0,r.kt)("inlineCode",{parentName:"p"},"update()")," ",(0,r.kt)("em",{parentName:"p"},"append")," new data to the end of the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),". Otherwise, Perspective allows\n",(0,r.kt)("a",{parentName:"p",href:"#index-and-limit"},(0,r.kt)("em",{parentName:"a"},"partial updates")," (in-place)")," using the ",(0,r.kt)("inlineCode",{parentName:"p"},"index")," to determine\nwhich rows to update:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'indexed_table.update({id: [1, 4], name: ["x", "y"]});\n'))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'indexed_table.update({"id": [1, 4], "name": ["x", "y"]})\n')))),(0,r.kt)("p",null,"Any value on a ",(0,r.kt)("inlineCode",{parentName:"p"},"table()")," can be unset using the value ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," (Javascript) or\n",(0,r.kt)("inlineCode",{parentName:"p"},"None")," (Python). Values may be unset on construction, as any ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," in the\ndataset will be treated as an unset value, and can be explicitly unset via\n",(0,r.kt)("inlineCode",{parentName:"p"},"update()")," on a ",(0,r.kt)("inlineCode",{parentName:"p"},"table()")," with ",(0,r.kt)("inlineCode",{parentName:"p"},"index")," applied. ",(0,r.kt)("inlineCode",{parentName:"p"},"update()")," calls do not need\nvalues for ",(0,r.kt)("em",{parentName:"p"},"all columns")," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"table()")," schema; Missing keys (or keys with\nvalues set to ",(0,r.kt)("inlineCode",{parentName:"p"},"undefined")," in Javascript), will be omitted from ",(0,r.kt)("inlineCode",{parentName:"p"},"table()"),"s with\n",(0,r.kt)("inlineCode",{parentName:"p"},"index")," set, and become ",(0,r.kt)("inlineCode",{parentName:"p"},"null"),":"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"table.update([{x: 3, y: null}]); // `z` missing\n"))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'table.update([{"x": 3, "y": None}]) // `z` missing\n')))),(0,r.kt)("p",null,"Rows can also be removed from an indexed ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),", with an array of primary keys:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"indexed_table.remove([1, 4]);\n"))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"indexed_table.remove([1, 4])\n")))),(0,r.kt)("p",null,"Calling ",(0,r.kt)("inlineCode",{parentName:"p"},"clear()")," will remove all data from the underlying ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),". Calling\n",(0,r.kt)("inlineCode",{parentName:"p"},"replace(data)")," with new data will clear the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),", and update it with a new\ndataset that conforms to Perspective's data types and the existing schema on the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Table"),"."),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"table.clear();\ntable.replace(json);\n"))),(0,r.kt)(o.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"table.clear()\ntable.replace(df2)\n")))))}h.isMDXComponent=!0}}]);